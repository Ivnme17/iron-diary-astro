<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ironTV</title>
  <link rel="icon" type="image/svg+xml" href="/favicon.svg"/>
  <link rel="icon" type="image/x-icon" href="/favicon.ico"/>
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:wght@300;400;600;700&display=swap" rel="stylesheet"/>
  <style>
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
    :root{
      --bg:#090909;--surface:#111;--card:#141414;--border:#1e1e1e;
      --accent:#ff3c00;--accent2:#ff8c00;--text:#f0f0f0;--muted:#555;
      --fd:'Bebas Neue',sans-serif;--fb:'DM Sans',sans-serif;
    }
    body{background:var(--bg);color:var(--text);font-family:var(--fb);min-height:100vh;overflow-x:hidden}
    .header{position:sticky;top:0;z-index:100;background:rgba(9,9,9,.95);-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);height:58px;display:flex;align-items:center;justify-content:space-between;padding:0 20px}
    .logo{display:flex;align-items:center;gap:8px}
    .logo-mark{width:30px;height:30px;background:var(--accent);border-radius:7px;display:flex;align-items:center;justify-content:center;font-size:14px}
    .logo-name{font-family:var(--fd);font-size:28px;letter-spacing:3px;background:linear-gradient(90deg,#fff,var(--accent2));-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent}
    .beta{font-size:9px;font-weight:700;letter-spacing:1.5px;color:var(--accent);border:1px solid var(--accent);padding:2px 5px;border-radius:3px;margin-top:6px}
    .add-btn{background:var(--accent);color:#fff;border:none;border-radius:8px;padding:8px 16px;font-family:var(--fb);font-weight:700;font-size:13px;cursor:pointer;transition:background .2s,transform .1s}
    .add-btn:hover{background:#d93000;transform:scale(1.04)}
    .back-btn{background:var(--surface);color:var(--text);border:1px solid var(--border);border-radius:8px;padding:8px 16px;font-family:var(--fb);font-weight:600;font-size:13px;cursor:pointer;transition:all .2s,transform .1s;text-decoration:none;display:inline-flex;align-items:center;gap:6px}
    .back-btn:hover{background:var(--card);border-color:#333;transform:scale(1.02)}
    .header-actions{display:flex;gap:12px;align-items:center}
    .cats{display:flex;gap:8px;overflow-x:auto;scrollbar-width:none;-ms-overflow-style:none;padding:14px 20px;border-bottom:1px solid var(--border)}
    .cats::-webkit-scrollbar{display:none}
    .pill{flex-shrink:0;padding:6px 16px;border-radius:999px;font-size:13px;font-weight:500;cursor:pointer;border:1px solid var(--border);background:var(--surface);color:var(--muted);transition:all .2s}
    .pill:hover{border-color:#333;color:var(--text)}
    .pill.on{background:var(--accent);border-color:var(--accent);color:#fff;font-weight:700}
    .layout{display:grid;grid-template-columns:1fr 340px;gap:20px;max-width:1300px;margin:0 auto;padding:20px}
    .player-wrap{position:sticky;top:78px;height:calc(100vh - 100px);max-height:760px}
    .player-card{position:relative;height:100%;border-radius:18px;overflow:hidden;background:#000;border:1px solid var(--border)}
    #mainIframe{width:100%;height:100%;border:none;display:none}
    .player-placeholder{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:16px;color:var(--muted)}
    .player-placeholder .ph-icon{font-size:52px;opacity:.3}
    .player-placeholder p{font-size:14px}
    .ov-bot{position:absolute;bottom:0;left:0;right:0;height:180px;background:linear-gradient(to top,rgba(0,0,0,.85),transparent);pointer-events:none}
    .video-meta{position:absolute;bottom:18px;left:20px;right:76px;z-index:10}
    .video-cat{font-size:10px;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--accent);margin-bottom:5px}
    .video-title{font-family:var(--fd);font-size:26px;letter-spacing:1px;line-height:1.1;margin-bottom:6px;text-shadow:0 2px 8px rgba(0,0,0,.8)}
    .video-author{font-size:13px;color:rgba(255,255,255,.6);display:flex;align-items:center;gap:6px}
    .author-dot{width:18px;height:18px;border-radius:50%;background:var(--accent);flex-shrink:0}
    .actions{position:absolute;right:12px;bottom:86px;display:flex;flex-direction:column;gap:16px;align-items:center;z-index:10}
    .act{display:flex;flex-direction:column;align-items:center;gap:3px;cursor:pointer;background:none;border:none;color:#fff}
    .act-icon{width:42px;height:42px;border-radius:50%;background:rgba(255,255,255,.12);-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);display:flex;align-items:center;justify-content:center;font-size:18px;transition:background .2s,transform .15s}
    .act:hover .act-icon{background:rgba(255,60,0,.35);transform:scale(1.1)}
    .act.liked .act-icon{background:rgba(255,60,0,.65)}
    .act-label{font-size:10px;font-weight:700;color:rgba(255,255,255,.7)}
    .feed-head{font-family:var(--fd);font-size:20px;letter-spacing:1px;margin-bottom:10px}
    .feed-count{font-size:12px;color:var(--muted);margin-bottom:14px}
    .feed{display:flex;flex-direction:column;gap:10px}
    .reel{display:grid;grid-template-columns:94px 1fr;gap:10px;background:var(--card);border:1px solid var(--border);border-radius:12px;padding:10px;cursor:pointer;transition:border-color .2s,transform .2s;position:relative;overflow:hidden}
    .reel::after{content:'';position:absolute;left:0;top:0;bottom:0;width:3px;background:var(--accent);opacity:0;transition:opacity .2s}
    .reel:hover::after{opacity:1}
    .reel:hover{border-color:var(--accent);transform:translateX(2px)}
    .reel-thumb{width:94px;height:53px;background:#222;border-radius:8px;object-fit:cover}
    .reel-info{display:flex;flex-direction:column;gap:4px;min-width:0}
    .reel-title{font-size:14px;font-weight:600;line-height:1.2;color:var(--text);display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;line-clamp:2;box-orient:vertical}
    .reel-author{font-size:12px;color:var(--muted)}
    .reel-stats{font-size:11px;color:var(--muted)}
    .modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.8);z-index:1000;align-items:center;justify-content:center;padding:20px}
    .modal.show{display:flex}
    .modal-content{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:24px;width:100%;max-width:400px}
    .modal-title{font-family:var(--fd);font-size:20px;letter-spacing:1px;margin-bottom:16px}
    .fg{margin-bottom:16px}
    .fg label{display:block;font-size:13px;font-weight:600;color:var(--text);margin-bottom:6px}
    .fg input,.fg select{width:100%;padding:10px;border-radius:8px;border:1px solid var(--border);background:var(--card);color:var(--text);font-family:var(--fb);font-size:14px}
    .fg input:focus,.fg select:focus{border-color:var(--accent)}
    .fg select option{background:#111}
    .modal-btns{display:flex;gap:8px;margin-top:20px}
    .btn-cancel{flex:1;padding:11px;border-radius:9px;border:1px solid var(--border);background:none;color:var(--muted);font-family:var(--fb);font-size:14px;cursor:pointer;transition:border-color .2s}
    .btn-cancel:hover{border-color:#333;color:var(--text)}
    .btn-add{flex:2;padding:11px;border-radius:9px;border:none;background:var(--accent);color:#fff;font-family:var(--fb);font-size:14px;font-weight:700;cursor:pointer;transition:background .2s}
    .btn-add:hover{background:#d93000}
    .toast{position:fixed;bottom:24px;left:50%;transform:translateX(-50%) translateY(20px);background:#1c1c1c;border:1px solid #333;border-radius:10px;padding:10px 20px;font-size:13px;font-weight:600;opacity:0;transition:opacity .3s,transform .3s;z-index:300;pointer-events:none;white-space:nowrap}
    .toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
    .video-meta-hidden{display:none}
    @media (max-width:860px){
      .layout{grid-template-columns:1fr;gap:16px;padding:16px}
      .player-wrap{position:relative;top:0;height:60vw;max-height:400px}
      .feed-head{font-size:18px}
    }
  </style>
</head>
<body>

<header class="header">
  <div class="logo">
    <div class="logo-mark">‚ñ∂</div>
    <span class="logo-name">ironTV</span>
    <span class="beta">BETA</span>
  </div>
  <div class="header-actions">
    <a href="/" class="back-btn">‚Üê Inicio</a>
    <button class="add-btn" onclick="openModal()">+ Agregar video</button>
  </div>
</header>

<div class="cats" id="catsBar">
  <div class="pill on" data-cat="all">Todos</div>
  <div class="pill" data-cat="fuerza">üí™ Fuerza</div>
  <div class="pill" data-cat="cardio">üî• Cardio</div>
  <div class="pill" data-cat="hiit">‚ö° HIIT</div>
  <div class="pill" data-cat="movilidad">üßò Movilidad</div>
  <div class="pill" data-cat="nutricion">ü•ó Nutrici√≥n</div>
</div>

<div class="layout">
  <div class="player-wrap">
    <div class="player-card">
      <iframe id="mainIframe" allowfullscreen></iframe>
      <div class="player-placeholder" id="placeholder">
        <div class="ph-icon">‚ñ∂</div>
        <p>Selecciona un video para reproducir</p>
      </div>
      <div class="ov-bot"></div>
      <div class="video-meta" id="videoMeta" class="video-meta-hidden">
        <div class="video-cat" id="videoCat">CATEGOR√çA</div>
        <div class="video-title" id="videoTitle">T√≠tulo del video</div>
        <div class="video-author"><span class="author-dot"></span><span id="videoAuthor">Autor</span></div>
      </div>
      <div class="actions">
        <button class="act" id="likeBtn">
          <div class="act-icon">‚ô•</div>
          <div class="act-label" id="likeCount">0</div>
        </button>
      </div>
    </div>
  </div>

  <div>
    <div class="feed-head">VIDEOS RECIENTES</div>
    <div class="feed-count" id="feedCount">0 videos</div>
    <div class="feed" id="feed"></div>
  </div>
</div>

<div class="modal" id="addModal">
  <div class="modal-content">
    <div class="modal-title">Agregar Nuevo Video</div>
    <div class="fg">
      <label>T√≠tulo del Video</label>
      <input type="text" id="videoTitleInput" placeholder="Ej: 15 Minutos de Cardio Intenso">
    </div>
    <div class="fg">
      <label>Autor/Canal</label>
      <input type="text" id="videoAuthorInput" placeholder="Ej: FitnessPro">
    </div>
    <div class="fg">
      <label>URL del Video (YouTube)</label>
      <input type="text" id="videoUrlInput" placeholder="https://www.youtube.com/watch?v=...">
    </div>
    <div class="fg">
      <label>Categor√≠a</label>
      <select id="videoCatInput">
        <option value="fuerza">üí™ Fuerza</option>
        <option value="cardio">üî• Cardio</option>
        <option value="hiit">‚ö° HIIT</option>
        <option value="movilidad">üßò Movilidad</option>
        <option value="nutricion">ü•ó Nutrici√≥n</option>
      </select>
    </div>
    <div class="modal-btns">
      <button class="btn-cancel" onclick="closeModal()">Cancelar</button>
      <button class="btn-add" onclick="addVideo()">Agregar Video</button>
    </div>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
  let videos = JSON.parse(localStorage.getItem('ironTVVideos') || '[]');
  let currentVideo = null;
  let currentFilter = 'all';

  function getYouTubeId(url) {
    const match = url.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\n?#]+)/);
    return match ? match[1] : null;
  }

  function getYouTubeThumbnail(url) {
    const id = getYouTubeId(url);
    return id ? `https://img.youtube.com/vi/${id}/mqdefault.jpg` : 'https://via.placeholder.com/320x180?text=Video';
  }

  function saveVideos() {
    localStorage.setItem('ironTVVideos', JSON.stringify(videos));
  }

  function renderFeed() {
    const feed = document.getElementById('feed');
    const feedCount = document.getElementById('feedCount');
    const filtered = currentFilter === 'all' ? videos : videos.filter(v => v.category === currentFilter);
    
    feedCount.textContent = `${filtered.length} video${filtered.length !== 1 ? 's' : ''}`;
    
    if (filtered.length === 0) {
      feed.innerHTML = '<div style="text-align:center;color:var(--muted);padding:40px 0;">No hay videos en esta categor√≠a</div>';
      return;
    }
    
    feed.innerHTML = filtered.map(video => `
      <div class="reel" onclick="playVideo('${video.id}')">
        <img src="${video.thumbnail}" alt="${video.title}" class="reel-thumb">
        <div class="reel-info">
          <div class="reel-title">${video.title}</div>
          <div class="reel-author">${video.author}</div>
          <div class="reel-stats">${video.views || 0} visualizaciones</div>
        </div>
      </div>
    `).join('');
  }

  function playVideo(id) {
    const video = videos.find(v => v.id === id);
    if (!video) return;
    
    currentVideo = video;
    const iframe = document.getElementById('mainIframe');
    const placeholder = document.getElementById('placeholder');
    const videoMeta = document.getElementById('videoMeta');
    
    iframe.src = `https://www.youtube.com/embed/${getYouTubeId(video.url)}?autoplay=1`;
    iframe.style.display = 'block';
    placeholder.style.display = 'none';
    videoMeta.style.display = 'block';
    videoMeta.classList.remove('video-meta-hidden');
    
    document.getElementById('videoCat').textContent = video.category.toUpperCase();
    document.getElementById('videoTitle').textContent = video.title;
    document.getElementById('videoAuthor').textContent = video.author;
    document.getElementById('likeCount').textContent = video.likes || 0;
    
    // Update like button state
    const likeBtn = document.getElementById('likeBtn');
    if (video.liked) {
      likeBtn.classList.add('liked');
    } else {
      likeBtn.classList.remove('liked');
    }
    
    // Increment views
    video.views = (video.views || 0) + 1;
    saveVideos();
    renderFeed();
  }

  function openModal() {
    document.getElementById('addModal').classList.add('show');
    // Clear form
    document.getElementById('videoTitleInput').value = '';
    document.getElementById('videoAuthorInput').value = '';
    document.getElementById('videoUrlInput').value = '';
    document.getElementById('videoCatInput').value = 'fuerza';
  }

  function closeModal() {
    document.getElementById('addModal').classList.remove('show');
  }

  function addVideo() {
    const title = document.getElementById('videoTitleInput').value.trim();
    const author = document.getElementById('videoAuthorInput').value.trim();
    const url = document.getElementById('videoUrlInput').value.trim();
    const category = document.getElementById('videoCatInput').value;
    
    if (!title || !author || !url) {
      showToast('Por favor completa todos los campos');
      return;
    }
    
    const youtubeId = getYouTubeId(url);
    if (!youtubeId) {
      showToast('URL de YouTube inv√°lida');
      return;
    }
    
    const newVideo = {
      id: Date.now().toString(),
      title,
      author,
      url,
      category,
      thumbnail: getYouTubeThumbnail(url),
      likes: 0,
      views: 0,
      liked: false,
      addedAt: new Date().toISOString()
    };
    
    videos.unshift(newVideo);
    saveVideos();
    renderFeed();
    closeModal();
    showToast('Video agregado exitosamente');
  }

  function showToast(message) {
    const toast = document.getElementById('toast');
    toast.textContent = message;
    toast.classList.add('show');
    setTimeout(() => toast.classList.remove('show'), 3000);
  }

  // Like functionality
  document.getElementById('likeBtn').addEventListener('click', function() {
    if (!currentVideo) return;
    
    currentVideo.liked = !currentVideo.liked;
    if (currentVideo.liked) {
      currentVideo.likes = (currentVideo.likes || 0) + 1;
      this.classList.add('liked');
    } else {
      currentVideo.likes = Math.max(0, (currentVideo.likes || 0) - 1);
      this.classList.remove('liked');
    }
    
    document.getElementById('likeCount').textContent = currentVideo.likes;
    saveVideos();
  });

  // Category filter
  document.querySelectorAll('.pill').forEach(pill => {
    pill.addEventListener('click', function() {
      document.querySelectorAll('.pill').forEach(p => p.classList.remove('on'));
      this.classList.add('on');
      currentFilter = this.dataset.cat;
      renderFeed();
    });
  });

  // Close modal on outside click
  document.getElementById('addModal').addEventListener('click', function(e) {
    if (e.target === this) closeModal();
  });

  // Initial render
  renderFeed();

  // Add some sample videos if empty
  if (videos.length === 0) {
    videos = [
      {
        id: '1',
        title: '15 Minutos de Cardio Intenso para Quemar Grasa',
        author: 'FitnessPro',
        url: 'https://www.youtube.com/watch?v=ml6cT4AZdqI',
        category: 'cardio',
        thumbnail: 'https://img.youtube.com/vi/ml6cT4AZdqI/mqdefault.jpg',
        likes: 245,
        views: 1520,
        liked: false,
        addedAt: new Date().toISOString()
      },
      {
        id: '2',
        title: 'Rutina de Fuerza para Principiantes',
        author: 'GymExpert',
        url: 'https://www.youtube.com/watch?v=U0IttWCCSi8',
        category: 'fuerza',
        thumbnail: 'https://img.youtube.com/vi/U0IttWCCSi8/mqdefault.jpg',
        likes: 189,
        views: 980,
        liked: false,
        addedAt: new Date().toISOString()
      }
    ];
    saveVideos();
    renderFeed();
  }
</script>

</body>
</html>
